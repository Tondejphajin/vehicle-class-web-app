<form>
  <label for="input">Input:</label><br>
  <input type="file" id="input" name="input" multiple accept="image/*"><br>
  <br>
  <label for="width">Width:</label>
  <input type="number" id="width" name="width" value="200">
  <label for="height">Height:</label>
  <input type="number" id="height" name="height" value="200">
  <br><br>
  <button type="button" onclick="upload()">Upload</button>
  <br><br>
  <label for="output">Output:</label><br>
  <div id="output"></div>
  <br><br>
  <button type="button" onclick="send()">Send</button>
  <br><br>
  <label for="result">Result:</label><br>
  <textarea id="result" name="result" readonly></textarea>
</form> 

<script>
function upload() {
  var input = document.getElementById('input');
  var output = document.getElementById('output');
  var width = document.getElementById('width').value;
  var height = document.getElementById('height').value;
  for (var i = 0; i < input.files.length; i++) {
    var file = input.files[i];
    var img = document.createElement('img');
    img.onload = function() {
      var canvas = document.createElement('canvas');
      var ctx = canvas.getContext('2d');
      canvas.width = width;
      canvas.height = height;
      ctx.drawImage(this, 0, 0, width, height);
      output.appendChild(canvas);
    }
    img.src = URL.createObjectURL(file);
  }
}

function send() {
  var images = [];
  var output = document.getElementById('output');
  for (var i = 0; i < output.childNodes.length; i++) {
    var canvas = output.childNodes[i];
    images.push(canvas.toDataURL());
  }
  fetch("https://din321-land-vehicle-classification.hf.space/run/predict", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({
      data: images
    })
  })
  .then(r => r.json())
  .then(
    r => {
      let data = r.data;
      document.getElementById('result').value = JSON.stringify(data);
    }
  )
}
</script>
